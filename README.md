# B8 Project – X-ray Single-Photon Energy-Dispersive Spectroscopy Analysis

This repository contains a Python-based framework for analyzing CCD data from X-ray spectroscopy experiments using Bragg diffraction and single-photon counting (SPC). It also includes tools for spectrum reconstruction and synthetic dataset generation for testing and validation.

---

## Project Structure

```

B8_Project_NEW/
├── bragg_engine/                  # Bragg spectroscopy modules
├── spc_engine/                    # SPC and high-ADU photon detection
├── spectral_reconstruction/       # Energy mapping, spectral analysis, visualizations
├── synthetic_engine/              # Synthetic data generation tools
├── synthetic_dataset_example/     # Sample synthetic CCD and energy maps
├── 8/                             # Sample file generated by run_spc_engine of saved photon hit data for image 8
├── run_bragg_engine.py            # Bragg image analysis
├── run_spc_engine.py              # Single-photon counting and high-ADU clustering
├── run_spectral_reconstruction.py # Spectral reconstruction using photon hits
├── run_synthetic_engine.py        # Generates synthetic image + runs full pipeline
├── run_unit_tests.py              # Unified unit test runner
├── config.py                      # Centralized configuration
├── requirements.txt               # Python dependencies
└── README.md                      # This file
```

## Getting Started

### Clone the Repository:

Using SSH (recommended if you’ve added your key to GitHub):

```bash
git clone git@github.com:HelenaBhattacharya/B8_Project_NEW.git
cd B8
```

### Setup your environment:

Create a virtual environment and activate it:

```bash
python3 -m venv venv
source venv/bin/activate
```

(On Windows, activate with `venv\Scripts\activate`)

### Install dependencies:

```bash
pip install -r requirements.txt
```

## How to Run the Project

Each main component has a corresponding run_*.py script in the root directory.

### Bragg Engine
```bash
python3 run_bragg_engine.py                # Uses default sxro6416-r0504.h5 file from config.py
python3 run_bragg_engine.py my_file.h5    # Run with custom input file
```

### SPC Engine
```bash
python3 run_spc_engine.py                         # Run on all images in default file
python3 run_spc_engine.py --single_image 8        # Run on one image
python3 run_spc_engine.py my_file.h5 --single_image 3
```
### Spectral Reconstruction
```bash
python3 run_spectral_reconstruction.py                 # Run over all SPC results
python3 run_spectral_reconstruction.py --image_index 7 # Run for one image
python3 run_spectral_reconstruction.py my_file.h5
```
### Synthetic Engine
```bash
python3 run_synthetic_engine.py
```
### Unit tests
All unit tests validating Bragg calibration, spc algorithms and spectral reconstruction pipeline are run using:
```bash
python run_unit_tests.py
```
## Notes on Sample Data
